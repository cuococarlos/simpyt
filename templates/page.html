<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/assets/icons/icon.png">
    <link rel="manifest" href="/assets/manifest.webmanifest">
    <script>
        if ("serviceWorker" in navigator){
            navigator.serviceWorker.register("/assets/service-worker.js")
        }
    </script>
    <script src="https://unpkg.com/htmx.org@1.8.6" integrity="sha384-Bj8qm/6B+71E6FQSySofJOUjA/gq330vEqjFx9LakWybUySyI1IQHwPtbTU7bNwx" crossorigin="anonymous"></script>
</head>
<body>
    <style>
    #pit {}
    .page {
        height: 100vh;
        width: 100vw;
        gap: 1px;
        display: grid;
        grid-template-columns:{{ " auto" * page.width }};
        grid-template-rows:{{ " auto" * page.height }};
        background-color: {{ page.background }};
    }
    .control {
        background-color: rgba(255, 255, 255, 0.8);
        text-align: center;
        background-repeat: no-repeat;
        background-size: contain;
        background-position: center;
    }
    .control a {
        width: 100%;
        height: 100%;
        display: block;
    }

    {% for control in page.controls %}
    #control_{{ control.id }} {
        {% if control.image: %}
            background-image: url("/image/{{ control.image|default('none') }}");
        {% endif %}
        {% if control.color: %}
            background-color: {{ control.color }};
        {% endif %}
        grid-column-start: {{ control.column_start }};
        grid-column-end: {{ control.column_end }};
        grid-row-start: {{ control.row_start }};
        grid-row-end: {{ control.row_end }};
    }
    {% endfor %}
    </style>

    <h1>SimPyt</h1>
    <h3>{{ page.name }}</h3>

    <div id="pit">
        <div class="page">
        {% for control in page.controls %}
            <div class="control" id="control_{{ control.id }}" hx-get="/activate_control/{{ page.name }}/{{ control.id }}" hx-trigger="click" hx-swap="none" >
                {% if control.target_page: %}
                    <a href="/page/{{ control.target_page }}"></a>
                {% endif %}
            </div>
        {% endfor %}
        {% for control in [''] * page.extra_cells %}
            <div class="control"></div>
        {% endfor %}
        </div>
    </div>

    <p><a href="/page/{{ page.name }}/reload">Force reload</a></p>
    <p><a href="/">Home</a></p>
</body>
